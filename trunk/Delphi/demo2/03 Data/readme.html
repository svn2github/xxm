<h3>xxm Demo Projects - 03 Data</h3>
<p>This is a demo project showing how to set up a database connection in an xxm project.</p>
<dl>
<dt>Web.xxmp</dt>
<dd>The project file, contains an internal list of the files of the project, and other data about the project.<br />
Use xxmProject.exe to edit and manage project settings.</dd>
<dt>xxmp.pas</dt>
<dd>The project's main unit. When this file is missing form the project, xxm creates one for you.<br />
This one has been modified to include the <code>SetSession(Context);</code> call on LoadPage, linking each request to a new or existing session.</dd>
<dt>ADODB_TLB.pas</dt>
<dd>A generated unit based on the Type Library of the Microsoft ActiveX Data Objects (ADO).</dd>
<dt>queries.xml</dt>
<dd>An XML file holding the SQL queries the project uses.</dd>
<dt>xxmData.pas</dt>
<dd>This unit defines the TQueryResult and TDataChanger classes. It also defines the QueryStore that is used to store SQL queries. When initialized, <code>queries.xml</code> is loaded into memory.<br />
Please note <code>xxmData.pas</code> doesn't check for changes to <code>queries.xml</code>. A change made to <code>queries.xml</code> only will not cause the xxm project to (re)compile when you use a xxm*Dev handler.</dd>
<dt>xxmSession.pas</dt>
<dd>This unit defines the TxxmSession class. This website uses a single database connection object for each session. This works good for a small number of visitors, but websites that expect a larger number of visitors should implement a connection pool.<br />
Also note that the TxxmSession constructor checks if the QueryStore is already initialized. This can not be done when the project's DLL is started because this may happen in a different thread than the xxm project will run in. Within calls over the xxm project object, you're sure CoInitialize is called ans that you're on a thread that the website will run on.</dd>
<dt>demo.udl</dt>
<dd>This data-link file is used to have a fixed ADO connection string: "<code>File Name=demo.udl</code>". It depends on the process' current directory, which is set by the TxxmSession's constructor to the project's path.</dd>
<dt>demo.mdb</dt>
<dd>The demo UDL links to this file, also depending on the current directory.</dd>
<dt>Default.xxm</dt>
<dd>The website's default page. It lists the items of <code>Table1</code>, displaying an <i>edit</i> and <i>delete</i> link for each item. It also displays an <i>add</i> link. When looping over the query result, <code>Context.Connected</code> is checked, allowing the visitor to abort building the page when the list gets too long.</dd>
<dt>Edit.xxm</dt>
<dd>This page edits an item of <code>Table1</code>. It can also add an item to <code>Table1</code>. By querying for the item with <i>id=0</i> (which doesn't exist), TQueryResult returns default values for the edit form.</dd>
<dt>Delete.xxm</dt>
<dd>This page delete an item of <code>Table1</code>.</dd>
</dl>